# ALUMNI

ALUMNI: 复旦大学2021学年暑假学期《软件工程化开发》课程唯一小组的课程PJ，是一个开源的校友会平台

## 依赖

运行`pip install -r requirement.txt`安装以下依赖，或手动安装以下包

```
django==3.2.5
xlrd==1.2.0
requests==2.25.1
requests-html==0.10.0
pyexcel-xls
django-ckeditor
Pillow==8.3.1
```

## 目录介绍

后端项目的目录和主要文件介绍如下

```
Fduers/
|----Fduers/        存放django的配置文件
|----alumni/        是本项目的应用文件夹，存放后端的主要代码，包括数据库模型等一系列代码
	 ----migrations/	存放数据库迁移的代码
	 ----models.py		后端数据库模型的源代码
	 ----views.py		后端视图函数的源代码
			
|----functionality/ 存放功能性函数
|----generator/     存放测试数据生成器
|----property/		存放用于网页显示的资源(插件)
|----static/		存放一系列css和js代码
|----templates/		存放前端的静态页面
|----media/			存放图片等资源
|----db.sqlite3		后端数据库(sqlite格式的数据库)
|----manage.py		django的管理代码，通过python manage.py <指令> 可以进行各种操作
```

## 使用方法

1. 运行后端

   将项目克隆到本地后，运行`python manage.py runserver`即可将后端运行起来。后端的默认地址为`127.0.0.1:8000`(`localhost:8000`)。`runserver`指令也可以指定地址和端口。最常用的指令是`python manage.py runserver 0.0.0.0:8000`，使用该指令运行的后端可以在其他设备上通过`<ip>:8000`来访问。`<ip>`为你运行后端的ip地址。

2. 修改视图函数

   在代码设计中可能会存在修改视图函数的需求。修改完的视图函数是实时更新的，即，你不需要在修改完视图函数后重启后端，即可反应你的更改。

3. 数据库

   在测试过程中可能需要直接对数据库进行操作，这里对数据库进行一个简单的说明

   在本次push版本的数据库中，已经在后端数据库中导入了`省份`，`城市`，`院系`，以及一份用于测试的学生名单（用于用户注册时候的匹配）。这些数据可以直接打开`db.sqlite3`查看。需要注意的是，**之前的所有测试数据，包括用户和帖子内容全部被删除了**。

   数据库的内容是**静态**的，即：内容不会随着后端的运行结束而回滚；运行过程中所有插入或者删除的数据都会被记录下来。如果测试数据太多，想要重构数据库，可以直接用数据库软件删除`db.sqlite3`中的数据项，也可以将`db.sqlite3`文件直接删除，再运行`python manage.py migrate`来重构数据库。需要注意的是重构后的数据库中只包含`省份`，`城市`，`院系`以及`学生名单`(本次push版本)四个数据表的信息，所有后续添加的测试数据都会被删除。

   > `省份`，`城市`，`院系`以及`学生名单`是直接初始化进数据库的。如果还有需要直接初始化进数据库的数据，可以联系*沈溯*同学

## 版本修订

> 版本修订按照 添加，减少，*存在的bug*依次按照时间记录

* 2021.07.20

  本次push完善了代码文档，并且添加了数据库初始化功能

  本次push删除了之前所有写入数据库中的测试数据

  本次push的代码中尚存在bug，bug具体为：主站要求至少有3个帖子用于置顶，但是在帖子数量少于3个时会报错

